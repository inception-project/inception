<!--
  Licensed to the Technische Universität Darmstadt under one
  or more contributor license agreements. See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership. The Technische Universität Darmstadt
  licenses this file to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <parent>
    <groupId>de.tudarmstadt.ukp.inception.app</groupId>
    <artifactId>inception</artifactId>
    <version>35.0-SNAPSHOT</version>
  </parent>

  <artifactId>inception-app</artifactId>
  <packaging>pom</packaging>

  <properties>
    <maven.surefire.heap>6g</maven.surefire.heap>
    <maven.surefire.argLine>-XX:+EnableDynamicAgentLoading</maven.surefire.argLine>
    <maven.compiler.release>17</maven.compiler.release>
    <maven.compiler.target>${maven.compiler.release}</maven.compiler.target>
    <maven.compiler.source>${maven.compiler.release}</maven.compiler.source>
    <maven.build.timestamp.format>yyyy-MM-dd HH:mm</maven.build.timestamp.format>
    <dkpro.core.testCachePath>${session.executionRootDirectory}/cache/dkpro-core-datasets</dkpro.core.testCachePath>
    <excludedTestCategories>slow</excludedTestCategories>
    <npm-install-command>ci</npm-install-command>
  </properties>

  <dependencyManagement>
    <dependencies>
      <dependency>
        <groupId>de.tudarmstadt.ukp.inception.app</groupId>
        <artifactId>inception-dependencies</artifactId>
        <version>35.0-SNAPSHOT</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>
      <dependency>
        <groupId>de.tudarmstadt.ukp.inception.app</groupId>
        <artifactId>inception-bom</artifactId>
        <version>35.0-SNAPSHOT</version>
        <type>pom</type>
        <scope>import</scope>
      </dependency>
    </dependencies>
  </dependencyManagement>

  <dependencies>
    <!-- The logging subsystem used by INCEpTION -->
    <dependency>
      <!-- Use Log4J v2 as logging backend -->
      <groupId>org.apache.logging.log4j</groupId>
      <artifactId>log4j-core</artifactId>
      <scope>runtime</scope>
    </dependency>
    <dependency>
      <!-- Log4J2 support for Spring Boot and profiles -->
      <groupId>org.apache.logging.log4j</groupId>
      <artifactId>log4j-spring-boot</artifactId>
      <scope>runtime</scope>
    </dependency>
    <dependency>
      <!-- Use Log4J v2 as logging backend -->
      <groupId>org.apache.logging.log4j</groupId>
      <artifactId>log4j-slf4j2-impl</artifactId>
      <scope>runtime</scope>
    </dependency>
    <dependency>
      <!-- Route Log4J v1 over SLF4J -->
      <groupId>org.slf4j</groupId>
      <artifactId>log4j-over-slf4j</artifactId>
      <scope>runtime</scope>
    </dependency>
    <dependency>
      <!-- Route Java Util Logging over SLF4J -->
      <groupId>org.slf4j</groupId>
      <artifactId>jul-to-slf4j</artifactId>
      <scope>runtime</scope>
    </dependency>
    <dependency>
      <!-- Add json logger for Logstash -->
      <groupId>org.apache.logging.log4j</groupId>
      <artifactId>log4j-layout-template-json</artifactId>
    </dependency>
    <dependency>
      <!-- Route Java Commons Logging over SLF4J -->
      <groupId>org.springframework</groupId>
      <artifactId>spring-jcl</artifactId>
    </dependency>
    
    <!-- Dev aids -->
    <dependency>
      <groupId>com.google.code.findbugs</groupId>
      <artifactId>jsr305</artifactId>
      <scope>provided</scope>
    </dependency>

    <!-- Generation of Spring Property Metadata files -->
    <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-configuration-processor</artifactId>
      <optional>true</optional>
    </dependency>
    
    <!-- JAXB is no longer included with Java 9+ by default -->
    <!-- Old javax JAXB -->
    <dependency>
      <groupId>org.glassfish.jaxb</groupId>
      <artifactId>jaxb-runtime</artifactId>
      <scope>runtime</scope>
    </dependency>
    <dependency>
      <groupId>javax.xml.bind</groupId>
      <artifactId>jaxb-api</artifactId>
    </dependency>
    <dependency>
      <groupId>com.sun.xml.bind</groupId>
      <artifactId>jaxb-core</artifactId>
      <scope>runtime</scope>
    </dependency>
    <dependency>
      <groupId>javax.activation</groupId>
      <artifactId>javax.activation-api</artifactId>
      <scope>runtime</scope>
    </dependency>
    <!-- New jakarta JAXB -->
    <dependency>
      <groupId>jakarta.xml.bind</groupId>
      <artifactId>jakarta.xml.bind-api</artifactId>
    </dependency>
    <dependency>
      <groupId>com.sun.xml.bind</groupId>
      <artifactId>jaxb-impl</artifactId>
      <scope>runtime</scope>
    </dependency>
    
    <!-- Java Servlet API -->
    <dependency>
      <groupId>jakarta.servlet</groupId>
      <artifactId>jakarta.servlet-api</artifactId>
      <scope>provided</scope>
    </dependency>
    
    <dependency>
      <groupId>de.tudarmstadt.ukp.inception.app</groupId>
      <artifactId>inception-test-dependencies</artifactId>
      <version>${project.version}</version>
      <type>pom</type>
      <scope>test</scope>
    </dependency>
  </dependencies>

  <modules>
    <!-- Build infrastructure modules -->
    <module>inception-build</module>
    <module>inception-boot-loader</module>
    <!-- Core -->
    <module>inception-support-bootstrap</module>
    <module>inception-support</module>
    <module>inception-support-standalone</module>
    <module>inception-model</module>
    <module>inception-model-vdoc</module>
    <module>inception-model-export</module>
    <module>inception-project</module>
    <module>inception-project-api</module>
    <module>inception-project-initializers</module>
    <module>inception-project-initializers-basic</module>
    <module>inception-project-initializers-doclabeling</module>
    <module>inception-project-initializers-phi</module>
    <module>inception-project-initializers-sentencelabeling</module>
    <module>inception-project-initializers-ud</module>
    <module>inception-project-initializers-wikidatalinking</module>
    <module>inception-project-export</module>
    <module>inception-remote</module>
    <module>inception-security</module>
    <module>inception-telemetry</module>
    <module>inception-ui-core</module>
    <module>inception-log</module>
    <module>inception-log-ui</module>
    <module>inception-scheduling</module>
    <module>inception-js-api</module>
    <module>inception-annotation-storage</module>
    <module>inception-annotation-storage-api</module>
    <module>inception-api-annotation</module>
    <module>inception-api-formats</module>
    <module>inception-documents-api</module>
    <module>inception-documents</module>
    <module>inception-api-editor</module>
    <module>inception-api-render</module>
    <module>inception-schema-api</module>
    <module>inception-export</module>
    <module>inception-export-api</module>
    <module>inception-diag</module>
    <module>inception-tutorial</module>
    <module>inception-testing</module>
    <module>inception-agreement</module>
    <module>inception-constraints</module>
    <module>inception-ui-agreement</module>
    <module>inception-ui-dashboard</module>
    <module>inception-ui-dashboard-activity</module>
    <module>inception-ui-project</module>
    <module>inception-ui-annotation</module>
    <module>inception-ui-scheduling</module>
    <module>inception-ui-tagsets</module>
    <module>inception-sharing</module>
    <module>inception-preferences</module>
    <module>inception-processing</module>
    <module>inception-guidelines</module>
    <module>inception-schema</module>
    <!-- IO -->
    <module>inception-io-bioc</module>
    <module>inception-io-brat</module>
    <module>inception-io-conll</module>
    <module>inception-io-docx</module>
    <module>inception-io-json</module>
    <module>inception-io-html</module>
    <module>inception-io-nif</module>
    <module>inception-io-lif</module>
    <module>inception-io-perseus</module>
    <module>inception-io-imscwb</module>
    <module>inception-io-intertext</module>
    <module>inception-io-rdf</module>
    <module>inception-io-tcf</module>
    <module>inception-io-tei</module>
    <module>inception-io-text</module>
    <module>inception-io-webanno-tsv</module>
    <module>inception-io-xmi</module>
    <module>inception-io-xml</module>
    <!-- Curation -->
    <module>inception-curation</module>
    <module>inception-curation-legacy</module>
    <module>inception-ui-curation</module>
    <!-- Internal search -->
    <module>inception-ui-search</module>
    <module>inception-search-core</module>
    <module>inception-search-mtas-upstream</module>
    <module>inception-search-mtas</module>
    <!-- External search -->
    <module>inception-external-search-core</module>
    <module>inception-external-search-opensearch</module>
    <module>inception-external-search-solr</module>
    <module>inception-external-search-pubannotation</module>
    <module>inception-external-search-pubmed</module>
    <module>inception-ui-external-search</module>
    <!-- Knowledge base -->
    <module>inception-kb</module>
    <module>inception-kb-fact-linking</module>
    <module>inception-kb-lucene-sail</module>
    <module>inception-ui-kb</module>
    <module>inception-concept-linking</module>
    <!-- Editor extensions -->
    <module>inception-brat-editor</module>
    <module>inception-diam-api</module>
    <module>inception-diam</module>
    <module>inception-diam-compactv2</module>
    <module>inception-diam-editor</module>
    <module>inception-external-editor</module>
    <module>inception-html-editor</module>
    <module>inception-html-apache-annotator-editor</module>
    <module>inception-html-recogito-editor</module>
    <module>inception-pdf-editor</module>
    <module>inception-pdf-editor2</module>
    <module>inception-review-editor</module>
    <!-- Schema extensions -->
    <module>inception-layer-docmetadata</module>
    <module>inception-feature-lookup</module>
    <module>inception-image</module>
    <!-- Recommender system -->
    <module>inception-recommendation-api</module>
    <module>inception-recommendation</module>
    <module>inception-active-learning</module>
    <module>inception-imls-azureai-openai</module>
    <module>inception-imls-chatgpt</module>
    <module>inception-imls-opennlp</module>
    <module>inception-imls-stringmatch</module>
    <module>inception-imls-elg</module>
    <module>inception-imls-hf</module>
    <module>inception-imls-external</module>
    <module>inception-imls-lapps</module>
    <module>inception-imls-ollama</module>
    <module>inception-imls-support-llm</module>
    <module>inception-imls-weblicht</module>
    <!-- Documentation -->
    <module>inception-doc</module>
    <!-- Workload -->
    <module>inception-workload</module>
    <module>inception-workload-dynamic</module>
    <module>inception-workload-matrix</module>
    <module>inception-workload-ui</module>
    <!-- Plug-in support -->
    <module>inception-plugin-api</module>
    <module>inception-plugin-manager</module>
    <module>inception-plugin-parent</module>
    <!-- Application -->
    <module>inception-app-webapp</module>
    <!-- Examples -->
    <module>inception-example-imls-data-majority</module>
    <!--<module>inception-imls-dl4j</module>-->
    <!-- Packaging -->
    <module>inception-docker</module>
    <!-- Versioning -->
    <module>inception-versioning</module>
    <module>inception-websocket</module>
  </modules>

  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-clean-plugin</artifactId>
        <executions>
          <execution>
            <id>clean nodejs lib folder</id>
            <phase>clean</phase>
            <inherited>false</inherited>
            <goals>
              <goal>clean</goal>
            </goals>
            <configuration>
              <filesets>
                <fileset>
                  <directory>nodejs/lib</directory>
                  <followSymlinks>false</followSymlinks>
                </fileset>
              </filesets>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <configuration>
          <annotationProcessorPaths>
            <path>
              <groupId>org.hibernate.orm</groupId>
              <artifactId>hibernate-jpamodelgen</artifactId>
              <version>${hibernate.version}</version>
            </path>
            <path>
              <groupId>org.apache.logging.log4j</groupId>
              <artifactId>log4j-core</artifactId>
              <version>${log4j2.version}</version>
            </path>
          </annotationProcessorPaths>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-jar-plugin</artifactId>
        <executions>
          <execution>
            <goals>
              <goal>test-jar</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-javadoc-plugin</artifactId>
        <configuration>
          <notimestamp>true</notimestamp>
          <doclint>all,-missing</doclint>
          <!-- Exclude UIMA types -->
          <sourceFileExcludes>
            <exclude>**/*_Type.java</exclude>
            <exclude>**/webanno/constraints/grammar/**/*.java</exclude>
          </sourceFileExcludes>
          <tags>
            <tag>
              <name>generated</name>
              <placement>X</placement>
            </tag>
            <tag>
              <name>ordered</name>
              <placement>X</placement>
            </tag>
            <tag>
              <name>modifiable</name>
              <placement>X</placement>
            </tag>
            <tag>
              <name>forRemoval</name>
              <placement>X</placement>
            </tag>
          </tags>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>buildnumber-maven-plugin</artifactId>
        <version>3.2.0</version>
        <executions>
          <execution>
            <phase>validate</phase>
            <goals>
              <goal>create</goal>
            </goals>
          </execution>
        </executions>
        <configuration>
          <timestampFormat>yyyy-MM-dd HH:mm:ss</timestampFormat>
          <doCheck>false</doCheck>
          <doUpdate>false</doUpdate>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-dependency-plugin</artifactId>
        <executions>
          <execution>
            <id>default</id>
            <phase>verify</phase>
            <goals>
              <goal>analyze-only</goal>
            </goals>
          </execution>
        </executions>
        <configuration>
          <failOnWarning>true</failOnWarning>
          <ignoredUnusedDeclaredDependencies combine.children="append">
            <!--
              - Logging is used via reflection and cannot be detected by Maven
            -->
            <dependency>org.apache.logging.log4j:log4j-slf4j2-impl</dependency>
            <dependency>org.apache.logging.log4j:log4j-spring-boot</dependency>
            <dependency>org.apache.logging.log4j:log4j-layout-template-json</dependency>
            <dependency>org.apache.logging.log4j:log4j-core</dependency>
            <dependency>org.slf4j:log4j-over-slf4j</dependency>
            <dependency>org.slf4j:jul-to-slf4j</dependency>
            <dependency>commons-logging:commons-logging</dependency>
            <dependency>org.springframework:spring-jcl</dependency>
            <!--
              - JAXB is used via reflection and cannot be detected by Maven
            -->
            <dependency>jakarta.xml.bind:jakarta.xml.bind-api</dependency>
            <dependency>org.glassfish.jaxb</dependency>
            <dependency>javax.xml.bind:jaxb-api</dependency>
            <dependency>com.sun.xml.bind:jaxb-core</dependency>
            <dependency>com.sun.xml.bind:jaxb-impl</dependency>
            <dependency>javax.activation:javax.activation-api</dependency>
            <!--
              - Servlet API
            -->
            <dependency>jakarta.servlet:jakarta.servlet-api</dependency>

            <!--
              - hsqldb and data-jpa, used via reflection in tests in search-mtas,
              - cannot be detected by Maven
            -->
            <dependency>org.hsqldb:hsqldb</dependency>
            <dependency>org.springframework.boot:spring-boot-starter-data-jpa</dependency>
            <!--
              - Dev aids 
              -->
            <dependency>com.google.code.findbugs:jsr305</dependency>
            <!-- 
              - Generation of Spring Property Metadata files 
              -->
            <dependency>org.springframework.boot:spring-boot-configuration-processor</dependency>
            <!-- 
              - Generation of constants for I18N properties files
              -->
            <dependency>com.github.kklisura.java.processing:props-to-constants-generator</dependency>
            <!--
              - Common test dependencies
            -->
            <dependency>de.tudarmstadt.ukp.inception.app:inception-test-dependencies</dependency>
<!--            <dependency>com.squareup.okhttp3:mockwebserver</dependency>-->
<!--            <dependency>com.squareup.okhttp3:okhttp</dependency>-->
<!--            <dependency>com.squareup.okio:okio</dependency>-->
<!--            <dependency>com.squareup.okio:okio-jvm</dependency>-->
            <dependency>org.springframework.boot:spring-boot-starter-web</dependency>
<!--            <dependency>org.springframework.boot:spring-boot-starter-validation</dependency>-->
<!--            <dependency>org.springframework.boot:spring-boot-starter-data-jpa</dependency>-->
<!--            <dependency>org.springframework.security:spring-security-test</dependency>-->
<!--            <dependency>org.hsqldb:hsqldb</dependency>-->
          </ignoredUnusedDeclaredDependencies>
          <ignoredUsedUndeclaredDependencies>
            <dependency>org.junit.jupiter:*</dependency>
            <dependency>org.junit.platform:*</dependency>
            <dependency>org.assertj:*</dependency>
            <dependency>org.mockito:*</dependency>
            <dependency>org.xmlunit:*</dependency>
            <dependency>org.awaitility:awaitility</dependency>
            <dependency>org.springframework:spring-test</dependency>
            <dependency>org.springframework.boot:spring-boot-test</dependency>
            <dependency>org.springframework.boot:spring-boot-test-autoconfigure</dependency>
            <dependency>com.squareup.okhttp3:mockwebserver</dependency>
            <dependency>com.squareup.okhttp3:okhttp</dependency>
            <dependency>com.squareup.okio:okio-jvm</dependency>
          </ignoredUsedUndeclaredDependencies>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-enforcer-plugin</artifactId>
        <executions>
          <execution>
            <id>enforce-maven</id>
            <goals>
              <goal>enforce</goal>
            </goals>
            <configuration>
              <rules>
                <requireJavaVersion>
                  <version>[${maven.compiler.release},)</version>
                </requireJavaVersion>
                <bannedDependencies>
                  <excludes>
                    <exclude>commons-logging:commons-logging</exclude>
                    <exclude>commons-logging:commons-logging-api</exclude>
                    <exclude>org.slf4j:jcl-over-slf4j</exclude>
                  </excludes>
                </bannedDependencies>
              </rules>
            </configuration>
          </execution>
        </executions>
      </plugin>
    </plugins>
    <pluginManagement>
      <plugins>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-resources-plugin</artifactId>
          <version>3.3.1</version>
          <configuration>
            <encoding>${project.build.sourceEncoding}</encoding>
            <propertiesEncoding>${project.build.sourceEncoding}</propertiesEncoding>
          </configuration>
        </plugin>
        <plugin>
          <groupId>com.helger.maven</groupId>
          <artifactId>ph-javacc-maven-plugin</artifactId>
          <version>4.1.5</version>
        </plugin>
        <plugin>
          <groupId>io.github.swagger2markup</groupId>
          <artifactId>swagger2markup-maven-plugin</artifactId>
          <version>1.3.7</version>
        </plugin>
        <plugin>
          <groupId>org.apache.rat</groupId>
          <artifactId>apache-rat-plugin</artifactId>
          <version>0.15</version>
        </plugin>
        <plugin>
          <groupId>org.codehaus.mojo</groupId>
          <artifactId>exec-maven-plugin</artifactId>
          <version>3.1.0</version>
        </plugin>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-dependency-plugin</artifactId>
          <version>3.6.0</version>
        </plugin>
        <plugin>
          <groupId>org.codehaus.gmaven</groupId>
          <artifactId>groovy-maven-plugin</artifactId>
          <version>2.1.1</version>
        </plugin>
        <plugin>
          <groupId>com.github.eirslett</groupId>
          <artifactId>frontend-maven-plugin</artifactId>
          <version>1.15.0</version>
        </plugin>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-release-plugin</artifactId>
          <configuration>
            <autoVersionSubmodules>true</autoVersionSubmodules>
            <useReleaseProfile>false</useReleaseProfile>
            <arguments>${arguments} -Dmaven.surefire.heap=${maven.surefire.heap} -Pdkpro-release</arguments>
          </configuration>
        </plugin>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-surefire-plugin</artifactId>
          <version>3.1.2</version>
          <configuration>
            <systemPropertyVariables>
              <dkpro.core.testCachePath>${dkpro.core.testCachePath}</dkpro.core.testCachePath>
            </systemPropertyVariables>
            <excludedGroups>${excludedTestCategories}</excludedGroups>
          </configuration>
        </plugin>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-war-plugin</artifactId>
          <version>3.4.0</version>
        </plugin>
        <plugin>
          <groupId>io.fabric8</groupId>
          <artifactId>docker-maven-plugin</artifactId>
          <version>0.43.0</version>
        </plugin>
        <plugin>
          <groupId>org.codehaus.mojo</groupId>
          <artifactId>versions-maven-plugin</artifactId>
          <version>2.16.0</version>
          <configuration>
            <rulesUri>file:${maven.multiModuleProjectDirectory}/inception/inception-build/src/main/resources/inception/rules.xml</rulesUri>
            <!--
            <allowAnyUpdates>false</allowAnyUpdates>
            <allowMajorUpdates>false</allowMajorUpdates>
            -->
          </configuration>
        </plugin>
      </plugins>
    </pluginManagement>
  </build>

  <profiles>
    <profile>
      <id>wicket-module</id>
      <activation>
        <file>
          <exists>marker-wicket-module</exists>
        </file>
      </activation>
      <build>
        <resources>
          <resource>
            <filtering>false</filtering>
            <directory>src/main/resources</directory>
            <excludes>
              <exclude>META-INF/version.properties</exclude>
            </excludes>
          </resource>
          <resource>
            <filtering>true</filtering>
            <directory>src/main/resources</directory>
            <includes>
              <include>META-INF/version.properties</include>
            </includes>
          </resource>
          <resource>
            <filtering>false</filtering>
            <directory>src/main/java</directory>
            <includes>
              <include>**</include>
            </includes>
            <excludes>
              <exclude>**/*.java</exclude>
            </excludes>
          </resource>
        </resources>
      </build>
    </profile>
    <profile>
      <id>m2e</id>
      <activation>
        <property>
          <name>m2e.version</name>
        </property>
      </activation>
      <build>
        <pluginManagement>
          <plugins>
            <plugin>
              <groupId>org.eclipse.m2e</groupId>
              <artifactId>lifecycle-mapping</artifactId>
              <version>1.0.0</version>
              <configuration>
                <lifecycleMappingMetadata>
                  <pluginExecutions>
                    <pluginExecution>
                      <!-- Activate groovy plugin in Eclipse -->
                      <pluginExecutionFilter>
                        <groupId>org.codehaus.gmaven</groupId>
                        <artifactId>groovy-maven-plugin</artifactId>
                        <versionRange>[2.1,)</versionRange>
                        <goals>
                          <goal>execute</goal>
                        </goals>
                      </pluginExecutionFilter>
                      <action combine.self="override">
                        <execute>
                          <runOnConfiguration>true</runOnConfiguration>
                          <runOnIncremental>true</runOnIncremental>
                        </execute>
                      </action>
                    </pluginExecution>
                    <pluginExecution>
                      <!-- Activate buildnumber plugin in Eclipse -->
                      <pluginExecutionFilter>
                        <groupId>org.codehaus.mojo</groupId>
                        <artifactId>buildnumber-maven-plugin</artifactId>
                        <versionRange>[0,)</versionRange>
                        <goals>
                          <goal>create</goal>
                        </goals>
                      </pluginExecutionFilter>
                      <action combine.self="override">
                        <execute>
                          <runOnConfiguration>true</runOnConfiguration>
                          <runOnIncremental>true</runOnIncremental>
                        </execute>
                      </action>
                    </pluginExecution>
                  </pluginExecutions>
                </lifecycleMappingMetadata>
              </configuration>
            </plugin>
          </plugins>
        </pluginManagement>
      </build>
    </profile>
    <profile>
      <id>rat-check</id>
      <activation>
        <file>
          <exists>src/main/java</exists>
        </file>
      </activation>
      <build>
        <plugins>
          <plugin>
            <groupId>org.apache.rat</groupId>
            <artifactId>apache-rat-plugin</artifactId>
            <executions>
              <execution>
                <id>default</id>
                <phase>verify</phase>
                <goals>
                  <goal>check</goal>
                </goals>
                <configuration>
                  <consoleOutput>true</consoleOutput>
                  <excludes combine.children="append">
                    <exclude>.mvn/jvm.config</exclude>
                    <exclude>.oracle_jre_usage/*.timestamp</exclude>
                    <exclude>.factorypath</exclude>
                    <exclude>.gitignore</exclude>
                    <exclude>.checkstyle</exclude>
                    <exclude>**/.asciidoctorconfig.adoc</exclude>
                    <exclude>**/.vscode/**/*</exclude>
                    <exclude>suppressions.xml</exclude>
                    <exclude>marker-*</exclude>
                    <!-- maven config files -->
                    <exclude>src/main/filter/**/*</exclude>
                    <!-- release generated artifact -->
                    <exclude>release.properties</exclude>
                    <!-- generated JCas wrappers -->
                    <exclude>src/main/java/**/type/**/*</exclude>
                    <!-- other -->
                    <exclude>CONTRIBUTORS.txt</exclude>
                    <exclude>CHANGES</exclude>
                    <exclude>CHANGES.txt</exclude>
                    <exclude>NOTICE</exclude>
                    <exclude>NOTICE.txt</exclude>
                    <exclude>README</exclude>
                    <exclude>README.txt</exclude>
                    <exclude>README.md</exclude>
                    <exclude>src/main/docker/**/*</exclude>
                    <exclude>src/main/resources/**/*</exclude>
                    <exclude>src/test/resources/**/*</exclude>
                    <exclude>**/cache/**/*</exclude>
                    <exclude>**/*.example</exclude>
                    <exclude>doc/*.json</exclude>
                    <exclude>licenses/**/*</exclude>
                    <exclude>**/mocha-test-report.xml</exclude>
                  </excludes>
                </configuration>
              </execution>
            </executions>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>run-jcasgen</id>
      <activation>
        <file>
          <exists>.activate-run-jcasgen</exists>
        </file>
      </activation>
      <build>
        <plugins>
          <plugin>
            <!--generate types dynamically -->
            <groupId>org.apache.uima</groupId>
            <artifactId>jcasgen-maven-plugin</artifactId>
            <version>${uima.version}</version>
            <configuration>
              <limitToProject>true</limitToProject>
              <typeSystemIncludes>
                <include>src/main/resources/desc/type/**/*.xml</include>
                <include>src/main/resources/de/tudarmstadt/ukp/clarin/webanno/**/type/**/*.xml</include>
              </typeSystemIncludes>
              <typeSystemExcludes>
                <exclude>src/main/resources/desc/type/**/*_customized.xml</exclude>
                <exclude>src/main/resources/de/tudarmstadt/ukp/clarin/webanno/**/type/**/*_customized.xml</exclude>
              </typeSystemExcludes>
            </configuration>
            <executions>
              <execution>
                <!--call it in the generate-source phase -->
                <phase>generate-sources</phase>
                <goals>
                  <goal>generate</goal>
                </goals>
              </execution>
            </executions>
          </plugin>
          <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>build-helper-maven-plugin</artifactId>
            <version>3.3.0</version>
            <executions>
              <execution>
                <id>addToSourceFolder</id>
                <goals>
                  <!--add the generated sources -->
                  <goal>add-source</goal>
                </goals>
                <phase>process-sources</phase>
                <configuration>
                  <sources>
                    <!--default path to generated sources -->
                    <source>${project.build.directory}/generated-sources/jcasgen</source>
                  </sources>
                </configuration>
              </execution>
            </executions>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>checkstyle</id>
      <activation>
        <file>
          <exists>src</exists>
        </file>
      </activation>
      <build>
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-checkstyle-plugin</artifactId>
          </plugin>
        </plugins>
        <pluginManagement>
          <plugins>
            <plugin>
              <groupId>org.apache.maven.plugins</groupId>
              <artifactId>maven-checkstyle-plugin</artifactId>
              <version>3.5.0</version>
              <inherited>true</inherited>
              <dependencies>
                <dependency>
                  <groupId>de.tudarmstadt.ukp.inception.app</groupId>
                  <artifactId>inception-build</artifactId>
                  <version>${project.version}</version>
                </dependency>
                <dependency>
                  <groupId>com.puppycrawl.tools</groupId>
                  <artifactId>checkstyle</artifactId>
                  <version>10.18.1</version>
                </dependency>
              </dependencies>
              <configuration>
                <!-- See: https://github.com/m2e-code-quality/m2e-code-quality/issues/117#issuecomment-380022879 -->
                <sourceDirectories>${project.compileSourceRoots}</sourceDirectories>
                <testSourceDirectories>${project.testCompileSourceRoots}</testSourceDirectories>
                <configLocation>inception/checkstyle.xml</configLocation>
                <propertyExpansion>basedir=${project.basedir}</propertyExpansion>
                <consoleOutput>true</consoleOutput>
                <failOnViolation>true</failOnViolation>
                <includeTestSourceDirectory>true</includeTestSourceDirectory>
                <includeResources>false</includeResources>
                <includeTestResources>false</includeTestResources>
                <logViolationsToConsole>true</logViolationsToConsole>
                <maxAllowedViolations>0</maxAllowedViolations>
                <violationSeverity>error</violationSeverity>
              </configuration>
              <executions>
                <execution>
                  <id>checkstyle-check</id>
                  <phase>verify</phase>
                  <goals>
                    <goal>check</goal>
                  </goals>
                </execution>
              </executions>
            </plugin>
          </plugins>
        </pluginManagement>
      </build>
    </profile>
    <profile>
      <id>doc-only</id>
      <properties>
        <mdep.analyze.skip>true</mdep.analyze.skip>
        <maven.main.skip>true</maven.main.skip>
        <maven.test.skip>true</maven.test.skip>
        <rat.skip>true</rat.skip>
        <maven.buildNumber.skip>true</maven.buildNumber.skip>
        <checkstyle.skip>true</checkstyle.skip>
        <spring-boot.repackage.skip>true</spring-boot.repackage.skip>
        <maven.war.skip>true</maven.war.skip>
        <remoteresources.skip>true</remoteresources.skip>
      </properties>
    </profile>
    <profile>
      <id>full-tests</id>
      <properties>
        <excludedTestCategories />
      </properties>
    </profile>
    <profile>
      <id>typescript-module</id>
      <activation>
        <file>
          <exists>src/main/ts_template/package.json</exists>
        </file>
      </activation>
      <properties>
        <ts-build-phase>generate-resources</ts-build-phase>
        <ts-test-phase>generate-test-resources</ts-test-phase>
        <ts-link-dependency-phase>generate-sources</ts-link-dependency-phase>
        <ts-link-phase>package</ts-link-phase>
        <ts-pack-phase>package</ts-pack-phase>
      </properties>
      <build>
        <plugins>
          <plugin>
            <groupId>org.codehaus.gmaven</groupId>
            <artifactId>groovy-maven-plugin</artifactId>
            <executions>
              <execution>
                <id>derive-npm-compatible-version</id>
                <phase>validate</phase>
                <goals>
                  <goal>execute</goal>
                </goals>
                <configuration>
                  <source><![CDATA[
                      def version = project.version as String
                      def suffix = "";
                      if (version.contains("-")) {
                          suffix = version.substring(version.indexOf("-") + 1, version.length());
                          version = version.substring(0, version.indexOf("-"));
                      }
                      
                      def versionParts = version.tokenize("\\.");
                      while (versionParts.size() < 3) { versionParts.add("0"); }; suffix = suffix.replace("-", "."); version = versionParts.join("."); if (suffix) { version = version + "-" + suffix; }; log.info("Semver representation of project version: " + version); project.properties.semver = version; ]]></source>
                </configuration>
              </execution>
            </executions>
          </plugin>
          <plugin>
            <artifactId>maven-clean-plugin</artifactId>
            <configuration>
              <filesets>
                <fileset>
                  <directory>src/main/ts/node_modules</directory>
                  <followSymlinks>false</followSymlinks>
                </fileset>
                <fileset>
                  <directory>src/main/ts</directory>
                  <includes>
                    <include>package.json</include>
                    <include>package-lock.json</include>
                  </includes>
                  <followSymlinks>false</followSymlinks>
                </fileset>
              </filesets>
            </configuration>
          </plugin>
          <plugin>
            <artifactId>maven-resources-plugin</artifactId>
            <executions>
              <execution>
                <id>stage-ts-build</id>
                <phase>initialize</phase>
                <goals>
                  <goal>copy-resources</goal>
                </goals>
                <configuration>
                  <outputDirectory>src/main/ts</outputDirectory>
                  <resources>
                    <resource>
                      <directory>src/main/ts_template</directory>
                      <filtering>true</filtering>
                    </resource>
                  </resources>
                </configuration>
              </execution>
            </executions>
          </plugin>
          <plugin>
            <groupId>com.github.eirslett</groupId>
            <artifactId>frontend-maven-plugin</artifactId>
            <configuration>
              <workingDirectory>src/main/ts</workingDirectory>
              <installDirectory>../nodejs</installDirectory>
              <nodeVersion>v${node.version}</nodeVersion>
            </configuration>
            <executions>
              <execution>
                <id>install node and npm</id>
                <goals>
                  <goal>install-node-and-npm</goal>
                </goals>
                <phase>initialize</phase>
              </execution>
              <execution>
                <id>npm install/ci</id>
                <goals>
                  <goal>npm</goal>
                </goals>
                <phase>${ts-build-phase}</phase>
                <configuration>
                  <arguments>${npm-install-command}</arguments>
                </configuration>
              </execution>
              <execution>
                <id>npm install license-checker</id>
                <goals>
                  <goal>npm</goal>
                </goals>
                <phase>${ts-build-phase}</phase>
                <configuration>
                  <arguments>install --no-save license-checker</arguments>
                </configuration>
              </execution>
              <execution>
                <id>npm generate license report</id>
                <goals>
                  <goal>npm</goal>
                </goals>
                <phase>${ts-build-phase}</phase>
                <configuration>
                  <environmentVariables>
                    <DEBUG>license-report*</DEBUG>
                  </environmentVariables>
                  <arguments>exec -- license-checker --production --out
                    ${project.build.directory}/js/META-INF/NPM-DEPENDENCIES.json --json --customPath
                    ../../../../inception-build/src/main/resources/inception/licenseCheckerCustomFormat.json
                    --excludePrivatePackages</arguments>
                </configuration>
              </execution>
              <execution>
                <id>npm link</id>
                <goals>
                  <goal>npm</goal>
                </goals>
                <phase>${ts-link-phase}</phase>
                <configuration>
                  <arguments>link</arguments>
                </configuration>
              </execution>
              <execution>
                <id>npm pack</id>
                <goals>
                  <goal>npm</goal>
                </goals>
                <phase>${ts-pack-phase}</phase>
                <configuration>
                  <arguments>pack --pack-destination=../../../target</arguments>
                </configuration>
              </execution>
            </executions>
          </plugin>
          <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>build-helper-maven-plugin</artifactId>
            <executions>
              <execution>
                <id>add-js-resources</id>
                <phase>${ts-build-phase}</phase>
                <goals>
                  <goal>add-resource</goal>
                </goals>
                <configuration>
                  <resources>
                    <resource>
                      <directory>target/js</directory>
                    </resource>
                  </resources>
                </configuration>
              </execution>
              <execution>
                <id>attach-artifacts</id>
                <phase>${ts-pack-phase}</phase>
                <goals>
                  <goal>attach-artifact</goal>
                </goals>
                <configuration>
                  <artifacts>
                    <artifact>
                      <file>${project.build.directory}/inception-project-${project.artifactId}-${semver}.tgz</file>
                      <classifier>npm</classifier>
                      <type>tgz</type>
                    </artifact>
                  </artifacts>
                </configuration>
              </execution>
            </executions>
          </plugin>
        </plugins>
        <pluginManagement>
          <plugins>
            <plugin>
              <groupId>org.apache.rat</groupId>
              <artifactId>apache-rat-plugin</artifactId>
              <configuration>
                <excludes combine.children="append">
                  <exclude>src/main/ts/.sass-cache/**</exclude>
                  <exclude>src/main/ts/.eslintrc.yml</exclude>
                  <exclude>src/main/ts/*.json</exclude>
                  <exclude>src/main/ts_template/*.json</exclude>
                  <exclude>src/main/ts/node_modules/**/*</exclude>
                  <exclude>**/mocha-test-report.xml</exclude>
                </excludes>
              </configuration>
            </plugin>
          </plugins>
        </pluginManagement>
      </build>
    </profile>
  </profiles>
</project>
