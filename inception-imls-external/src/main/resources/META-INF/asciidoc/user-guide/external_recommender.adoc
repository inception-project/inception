////
Parts of this document are generated by swagger2markup.
It can be run by calling

    mvn swagger2markup:convertSwagger2markup
    
from the inception-imls-external module. The output file then is

    inception-imls-external/target/asciidoc/external_recommender_api.adoc

When making changes to the API, just copy the stuff from there over to this document starting from [[_external_recommender_api_paths]]
////

[[_external_recommender_api_overview]]
= External recommender
This section describes the External Recommender API for INCEpTION. An external recommender is a classifier whose functionality is exposed via a HTTP web service. It can predict annotations for given documents and optionally be trained on new data. This document describes the endpoints a web service needs to expose so it can be used with INCEpTION.


The documents that are exchanged are in form of a UIMA CAS. For sending, they have to be serialized to CAS XMI and then encoded as base64. For receiving, these steps have to be undone. There are three main libraries available that manage CAS handling, one is the https://uima.apache.org/index.html[UIMA Java SDK], https://uima.apache.org/uimafit.html[uimaFIT] (Java) or https://github.com/dkpro/dkpro-cassis[dkpro-cassis]  (Python).

[[_external_recommender_api_paths]]
== Paths

[[_external_recommender_api_predictcas]]
=== Predict annotations for a single document
....
POST /predict
....


==== Description
Sends a CAS together with information about the layer and feature to predict to the external recommender. The external recommender then returns the CAS annotated with predictions.


==== Parameters

[options="header", cols=".^2,.^3,.^9,.^4"]
|===
|Type|Name|Description|Schema
|**Body**|**body** +
__required__|Document CAS for which annotations will be predicted|<<_external_recommender_api_predictrequest,PredictRequest>>
|===


==== Responses

[options="header", cols=".^2,.^14,.^4"]
|===
|HTTP Code|Description|Schema
|**200**|Successful prediction|<<_external_recommender_api_predictresponse,PredictResponse>>
|===


==== Consumes

* `application/json`


==== Produces

* `application/json`


==== Tags

* predict


==== Example HTTP request

===== Request path
----
/predict
----


===== Request body
[source,json]
----
{
  "layer" : "de.tudarmstadt.ukp.dkpro.core.api.ner.type.NamedEntity",
  "feature" : "value",
  "document" : "Cjw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+Cjx4bWk6WE1JIHhtbG5zOnRjYXM9Imh0dHA6Ly8vdWltYS90Y2FzLmVjb3JlIiB4bWxuczp4bWk9Imh0dHA6Ly93d3cub21nLm9yZy9YTUkiIHhtbG5zOmNhcz0iaHR0cDovLy91aW1hL2Nhcy5lY29yZSIKICAgICAgICAgeG1sbnM6Y2Fzc2lzPSJodHRwOi8vL2Nhc3Npcy5lY29yZSIgeG1pOnZlcnNpb249IjIuMCI+CiAgICA8Y2FzOk5VTEwgeG1pOmlkPSIwIi8+CiAgICA8dGNhczpEb2N1bWVudEFubm90YXRpb24geG1pOmlkPSI4IiBzb2ZhPSIxIiBiZWdpbj0iMCIgZW5kPSI0NyIgbGFuZ3VhZ2U9IngtdW5zcGVjaWZpZWQiLz4KICAgIDxjYXM6U29mYSB4bWk6aWQ9IjEiIHNvZmFOdW09IjEiIHNvZmFJRD0ibXlTb2ZhIiBtaW1lVHlwZT0idGV4dC9wbGFpbiIKICAgICAgICAgICAgICBzb2ZhU3RyaW5nPSJKb2Ugd2FpdGVkIGZvciB0aGUgdHJhaW4gLiBUaGUgdHJhaW4gd2FzIGxhdGUgLiIvPgogICAgPGNhczpWaWV3IHNvZmE9IjEiIG1lbWJlcnM9IjgiLz4KPC94bWk6WE1JPg==",
  "typeSystem" : "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHR5cGVTeXN0ZW1EZXNjcmlwdGlvbiB4bWxucz0iaHR0cDovL3VpbWEuYXBhY2hlLm9yZy9yZXNvdXJjZVNwZWNpZmllciI+CiAgICA8dHlwZXM+CiAgICAgICAgPHR5cGVEZXNjcmlwdGlvbj4KICAgICAgICAgICAgPG5hbWU+dWltYS50Y2FzLkRvY3VtZW50QW5ub3RhdGlvbjwvbmFtZT4KICAgICAgICAgICAgPGRlc2NyaXB0aW9uLz4KICAgICAgICAgICAgPHN1cGVydHlwZU5hbWU+dWltYS50Y2FzLkFubm90YXRpb248L3N1cGVydHlwZU5hbWU+CiAgICAgICAgICAgIDxmZWF0dXJlcz4KICAgICAgICAgICAgICAgIDxmZWF0dXJlRGVzY3JpcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPG5hbWU+bGFuZ3VhZ2U8L25hbWU+CiAgICAgICAgICAgICAgICAgICAgPGRlc2NyaXB0aW9uLz4KICAgICAgICAgICAgICAgICAgICA8cmFuZ2VUeXBlTmFtZT51aW1hLmNhcy5TdHJpbmc8L3JhbmdlVHlwZU5hbWU+CiAgICAgICAgICAgICAgICA8L2ZlYXR1cmVEZXNjcmlwdGlvbj4KICAgICAgICAgICAgPC9mZWF0dXJlcz4KICAgICAgICA8L3R5cGVEZXNjcmlwdGlvbj4KICAgIDwvdHlwZXM+CjwvdHlwZVN5c3RlbURlc2NyaXB0aW9uPg=="
}
----


==== Example HTTP response

===== Response 200
[source,json]
----
{
  "documents" : [ "Cjw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+Cjx4bWk6WE1JIHhtbG5zOnRjYXM9Imh0dHA6Ly8vdWltYS90Y2FzLmVjb3JlIiB4bWxuczp4bWk9Imh0dHA6Ly93d3cub21nLm9yZy9YTUkiIHhtbG5zOmNhcz0iaHR0cDovLy91aW1hL2Nhcy5lY29yZSIKICAgICAgICAgeG1sbnM6Y2Fzc2lzPSJodHRwOi8vL2Nhc3Npcy5lY29yZSIgeG1pOnZlcnNpb249IjIuMCI+CiAgICA8Y2FzOk5VTEwgeG1pOmlkPSIwIi8+CiAgICA8dGNhczpEb2N1bWVudEFubm90YXRpb24geG1pOmlkPSI4IiBzb2ZhPSIxIiBiZWdpbj0iMCIgZW5kPSI0NyIgbGFuZ3VhZ2U9IngtdW5zcGVjaWZpZWQiLz4KICAgIDxjYXM6U29mYSB4bWk6aWQ9IjEiIHNvZmFOdW09IjEiIHNvZmFJRD0ibXlTb2ZhIiBtaW1lVHlwZT0idGV4dC9wbGFpbiIKICAgICAgICAgICAgICBzb2ZhU3RyaW5nPSJKb2Ugd2FpdGVkIGZvciB0aGUgdHJhaW4gLiBUaGUgdHJhaW4gd2FzIGxhdGUgLiIvPgogICAgPGNhczpWaWV3IHNvZmE9IjEiIG1lbWJlcnM9IjgiLz4KPC94bWk6WE1JPg==" ]
}
----


[[_external_recommender_api_trainrecommender]]
=== Train recommender on a set of documents
....
POST /train
....


==== Description
Sends a list of CASses to the external recommender for training. No response body is expected.


==== Parameters

[options="header", cols=".^2,.^3,.^9,.^4"]
|===
|Type|Name|Description|Schema
|**Body**|**body** +
__required__|List of documents CAS whose annotations will be used for training|<<_external_recommender_api_train,Train>>
|===


==== Responses

[options="header", cols=".^2,.^14,.^4"]
|===
|HTTP Code|Description|Schema
|**204**|Successful training|No Content
|===


==== Consumes

* `application/json`


==== Tags

* train


==== Example HTTP request

===== Request path
----
/train
----


===== Request body
[source,json]
----
{
  "layer" : "de.tudarmstadt.ukp.dkpro.core.api.ner.type.NamedEntity",
  "feature" : "value",
  "documents" : [ "Cjw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+Cjx4bWk6WE1JIHhtbG5zOnRjYXM9Imh0dHA6Ly8vdWltYS90Y2FzLmVjb3JlIiB4bWxuczp4bWk9Imh0dHA6Ly93d3cub21nLm9yZy9YTUkiIHhtbG5zOmNhcz0iaHR0cDovLy91aW1hL2Nhcy5lY29yZSIKICAgICAgICAgeG1sbnM6Y2Fzc2lzPSJodHRwOi8vL2Nhc3Npcy5lY29yZSIgeG1pOnZlcnNpb249IjIuMCI+CiAgICA8Y2FzOk5VTEwgeG1pOmlkPSIwIi8+CiAgICA8dGNhczpEb2N1bWVudEFubm90YXRpb24geG1pOmlkPSI4IiBzb2ZhPSIxIiBiZWdpbj0iMCIgZW5kPSI0NyIgbGFuZ3VhZ2U9IngtdW5zcGVjaWZpZWQiLz4KICAgIDxjYXM6U29mYSB4bWk6aWQ9IjEiIHNvZmFOdW09IjEiIHNvZmFJRD0ibXlTb2ZhIiBtaW1lVHlwZT0idGV4dC9wbGFpbiIKICAgICAgICAgICAgICBzb2ZhU3RyaW5nPSJKb2Ugd2FpdGVkIGZvciB0aGUgdHJhaW4gLiBUaGUgdHJhaW4gd2FzIGxhdGUgLiIvPgogICAgPGNhczpWaWV3IHNvZmE9IjEiIG1lbWJlcnM9IjgiLz4KPC94bWk6WE1JPg==" ],
  "typeSystem" : "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHR5cGVTeXN0ZW1EZXNjcmlwdGlvbiB4bWxucz0iaHR0cDovL3VpbWEuYXBhY2hlLm9yZy9yZXNvdXJjZVNwZWNpZmllciI+CiAgICA8dHlwZXM+CiAgICAgICAgPHR5cGVEZXNjcmlwdGlvbj4KICAgICAgICAgICAgPG5hbWU+dWltYS50Y2FzLkRvY3VtZW50QW5ub3RhdGlvbjwvbmFtZT4KICAgICAgICAgICAgPGRlc2NyaXB0aW9uLz4KICAgICAgICAgICAgPHN1cGVydHlwZU5hbWU+dWltYS50Y2FzLkFubm90YXRpb248L3N1cGVydHlwZU5hbWU+CiAgICAgICAgICAgIDxmZWF0dXJlcz4KICAgICAgICAgICAgICAgIDxmZWF0dXJlRGVzY3JpcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPG5hbWU+bGFuZ3VhZ2U8L25hbWU+CiAgICAgICAgICAgICAgICAgICAgPGRlc2NyaXB0aW9uLz4KICAgICAgICAgICAgICAgICAgICA8cmFuZ2VUeXBlTmFtZT51aW1hLmNhcy5TdHJpbmc8L3JhbmdlVHlwZU5hbWU+CiAgICAgICAgICAgICAgICA8L2ZlYXR1cmVEZXNjcmlwdGlvbj4KICAgICAgICAgICAgPC9mZWF0dXJlcz4KICAgICAgICA8L3R5cGVEZXNjcmlwdGlvbj4KICAgIDwvdHlwZXM+CjwvdHlwZVN5c3RlbURlc2NyaXB0aW9uPg=="
}
----




[[_external_recommender_api_definitions]]
== Definitions

[[_external_recommender_api_predictrequest]]
=== PredictRequest

[options="header", cols=".^3,.^11,.^4"]
|===
|Name|Description|Schema
|**document** +
__required__|CAS as XMI which has been base64 encoded +
**Example** : `"Cjw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+Cjx4bWk6WE1JIHhtbG5zOnRjYXM9Imh0dHA6Ly8vdWltYS90Y2FzLmVjb3JlIiB4bWxuczp4bWk9Imh0dHA6Ly93d3cub21nLm9yZy9YTUkiIHhtbG5zOmNhcz0iaHR0cDovLy91aW1hL2Nhcy5lY29yZSIKICAgICAgICAgeG1sbnM6Y2Fzc2lzPSJodHRwOi8vL2Nhc3Npcy5lY29yZSIgeG1pOnZlcnNpb249IjIuMCI+CiAgICA8Y2FzOk5VTEwgeG1pOmlkPSIwIi8+CiAgICA8dGNhczpEb2N1bWVudEFubm90YXRpb24geG1pOmlkPSI4IiBzb2ZhPSIxIiBiZWdpbj0iMCIgZW5kPSI0NyIgbGFuZ3VhZ2U9IngtdW5zcGVjaWZpZWQiLz4KICAgIDxjYXM6U29mYSB4bWk6aWQ9IjEiIHNvZmFOdW09IjEiIHNvZmFJRD0ibXlTb2ZhIiBtaW1lVHlwZT0idGV4dC9wbGFpbiIKICAgICAgICAgICAgICBzb2ZhU3RyaW5nPSJKb2Ugd2FpdGVkIGZvciB0aGUgdHJhaW4gLiBUaGUgdHJhaW4gd2FzIGxhdGUgLiIvPgogICAgPGNhczpWaWV3IHNvZmE9IjEiIG1lbWJlcnM9IjgiLz4KPC94bWk6WE1JPg=="`|string
|**feature** +
__required__|Feature of the layer which should be predicted +
**Example** : `"value"`|string
|**layer** +
__required__|Layer which should be predicted +
**Example** : `"de.tudarmstadt.ukp.dkpro.core.api.ner.type.NamedEntity"`|string
|**typeSystem** +
__required__|Type system XML of the CAS which has been base64 encoded +
**Example** : `"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHR5cGVTeXN0ZW1EZXNjcmlwdGlvbiB4bWxucz0iaHR0cDovL3VpbWEuYXBhY2hlLm9yZy9yZXNvdXJjZVNwZWNpZmllciI+CiAgICA8dHlwZXM+CiAgICAgICAgPHR5cGVEZXNjcmlwdGlvbj4KICAgICAgICAgICAgPG5hbWU+dWltYS50Y2FzLkRvY3VtZW50QW5ub3RhdGlvbjwvbmFtZT4KICAgICAgICAgICAgPGRlc2NyaXB0aW9uLz4KICAgICAgICAgICAgPHN1cGVydHlwZU5hbWU+dWltYS50Y2FzLkFubm90YXRpb248L3N1cGVydHlwZU5hbWU+CiAgICAgICAgICAgIDxmZWF0dXJlcz4KICAgICAgICAgICAgICAgIDxmZWF0dXJlRGVzY3JpcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPG5hbWU+bGFuZ3VhZ2U8L25hbWU+CiAgICAgICAgICAgICAgICAgICAgPGRlc2NyaXB0aW9uLz4KICAgICAgICAgICAgICAgICAgICA8cmFuZ2VUeXBlTmFtZT51aW1hLmNhcy5TdHJpbmc8L3JhbmdlVHlwZU5hbWU+CiAgICAgICAgICAgICAgICA8L2ZlYXR1cmVEZXNjcmlwdGlvbj4KICAgICAgICAgICAgPC9mZWF0dXJlcz4KICAgICAgICA8L3R5cGVEZXNjcmlwdGlvbj4KICAgIDwvdHlwZXM+CjwvdHlwZVN5c3RlbURlc2NyaXB0aW9uPg=="`|string
|===


[[_external_recommender_api_predictresponse]]
=== PredictResponse

[options="header", cols=".^3,.^11,.^4"]
|===
|Name|Description|Schema
|**documents** +
__required__|CAS with annotations from the external recommender as XMI which has been base64 encoded +
**Example** : `[ "Cjw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+Cjx4bWk6WE1JIHhtbG5zOnRjYXM9Imh0dHA6Ly8vdWltYS90Y2FzLmVjb3JlIiB4bWxuczp4bWk9Imh0dHA6Ly93d3cub21nLm9yZy9YTUkiIHhtbG5zOmNhcz0iaHR0cDovLy91aW1hL2Nhcy5lY29yZSIKICAgICAgICAgeG1sbnM6Y2Fzc2lzPSJodHRwOi8vL2Nhc3Npcy5lY29yZSIgeG1pOnZlcnNpb249IjIuMCI+CiAgICA8Y2FzOk5VTEwgeG1pOmlkPSIwIi8+CiAgICA8dGNhczpEb2N1bWVudEFubm90YXRpb24geG1pOmlkPSI4IiBzb2ZhPSIxIiBiZWdpbj0iMCIgZW5kPSI0NyIgbGFuZ3VhZ2U9IngtdW5zcGVjaWZpZWQiLz4KICAgIDxjYXM6U29mYSB4bWk6aWQ9IjEiIHNvZmFOdW09IjEiIHNvZmFJRD0ibXlTb2ZhIiBtaW1lVHlwZT0idGV4dC9wbGFpbiIKICAgICAgICAgICAgICBzb2ZhU3RyaW5nPSJKb2Ugd2FpdGVkIGZvciB0aGUgdHJhaW4gLiBUaGUgdHJhaW4gd2FzIGxhdGUgLiIvPgogICAgPGNhczpWaWV3IHNvZmE9IjEiIG1lbWJlcnM9IjgiLz4KPC94bWk6WE1JPg==" ]`|< string > array
|===


[[_external_recommender_api_train]]
=== Train

[options="header", cols=".^3,.^11,.^4"]
|===
|Name|Description|Schema
|**documents** +
__required__|CAS as XMI which has been base64 encoded +
**Example** : `[ "Cjw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+Cjx4bWk6WE1JIHhtbG5zOnRjYXM9Imh0dHA6Ly8vdWltYS90Y2FzLmVjb3JlIiB4bWxuczp4bWk9Imh0dHA6Ly93d3cub21nLm9yZy9YTUkiIHhtbG5zOmNhcz0iaHR0cDovLy91aW1hL2Nhcy5lY29yZSIKICAgICAgICAgeG1sbnM6Y2Fzc2lzPSJodHRwOi8vL2Nhc3Npcy5lY29yZSIgeG1pOnZlcnNpb249IjIuMCI+CiAgICA8Y2FzOk5VTEwgeG1pOmlkPSIwIi8+CiAgICA8dGNhczpEb2N1bWVudEFubm90YXRpb24geG1pOmlkPSI4IiBzb2ZhPSIxIiBiZWdpbj0iMCIgZW5kPSI0NyIgbGFuZ3VhZ2U9IngtdW5zcGVjaWZpZWQiLz4KICAgIDxjYXM6U29mYSB4bWk6aWQ9IjEiIHNvZmFOdW09IjEiIHNvZmFJRD0ibXlTb2ZhIiBtaW1lVHlwZT0idGV4dC9wbGFpbiIKICAgICAgICAgICAgICBzb2ZhU3RyaW5nPSJKb2Ugd2FpdGVkIGZvciB0aGUgdHJhaW4gLiBUaGUgdHJhaW4gd2FzIGxhdGUgLiIvPgogICAgPGNhczpWaWV3IHNvZmE9IjEiIG1lbWJlcnM9IjgiLz4KPC94bWk6WE1JPg==" ]`|< string > array
|**feature** +
__required__|Feature of the layer which should be predicted +
**Example** : `"value"`|string
|**layer** +
__required__|Layer which should be predicted +
**Example** : `"de.tudarmstadt.ukp.dkpro.core.api.ner.type.NamedEntity"`|string
|**typeSystem** +
__required__|Type system XML of the CAS which has been base64 encoded +
**Example** : `"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHR5cGVTeXN0ZW1EZXNjcmlwdGlvbiB4bWxucz0iaHR0cDovL3VpbWEuYXBhY2hlLm9yZy9yZXNvdXJjZVNwZWNpZmllciI+CiAgICA8dHlwZXM+CiAgICAgICAgPHR5cGVEZXNjcmlwdGlvbj4KICAgICAgICAgICAgPG5hbWU+dWltYS50Y2FzLkRvY3VtZW50QW5ub3RhdGlvbjwvbmFtZT4KICAgICAgICAgICAgPGRlc2NyaXB0aW9uLz4KICAgICAgICAgICAgPHN1cGVydHlwZU5hbWU+dWltYS50Y2FzLkFubm90YXRpb248L3N1cGVydHlwZU5hbWU+CiAgICAgICAgICAgIDxmZWF0dXJlcz4KICAgICAgICAgICAgICAgIDxmZWF0dXJlRGVzY3JpcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPG5hbWU+bGFuZ3VhZ2U8L25hbWU+CiAgICAgICAgICAgICAgICAgICAgPGRlc2NyaXB0aW9uLz4KICAgICAgICAgICAgICAgICAgICA8cmFuZ2VUeXBlTmFtZT51aW1hLmNhcy5TdHJpbmc8L3JhbmdlVHlwZU5hbWU+CiAgICAgICAgICAgICAgICA8L2ZlYXR1cmVEZXNjcmlwdGlvbj4KICAgICAgICAgICAgPC9mZWF0dXJlcz4KICAgICAgICA8L3R5cGVEZXNjcmlwdGlvbj4KICAgIDwvdHlwZXM+CjwvdHlwZVN5c3RlbURlc2NyaXB0aW9uPg=="`|string
|===





